---
title: "Regression Project – Group 3 (Intermediate Report)"
author: "Reema Aboluhom and Muzammil Muhammad"
date: 09.12.2025
embed-resources: true
lightbox: true
fig-align: center
code-tools: true
code-link: true
number-sections: true
format:
  html: 
    toc: true
    toc-location: right
    code-link: true
    code-tools: true
    df-print: paged
  pdf:
    number-sections: true
    toc: true
  revealjs:
    output-ext: "revealjs-PRESENTATION.html"
    toc: false
    code-line-numbers: false
    echo: true
    scrollable: true
    code-link: true
    code-tools: true
    df-print: paged
    slide-number: true
---

## 

# 1. Introduction

-   The aim of this intermediate report is to explore determinants of income in South Austria.

-   We focus on data management and descriptive statistics before conducting regression modelling.

-   The response variable is net employment income (`py010n`).

-   Explanatory variables include gender, citizenship, household size, and age.

-   For the intermediate report we restrict to data management and descriptive statistics.

## 

# 2. Data collection and description

-   Source: EU-SILC (European Union Statistics on Income and Living Conditions), Austria.

-   Type of data: survey data, representative sample of private households.

-   Data format: cross-sectional microdata with social, demographic, and income information.

-   Variables used:

    -   `py010n` — employment income (numeric)

    -   `age` — age in years (numeric)

    -   `hsize` — household size (categorical converted to numeric)

    -   `gender` — male / female (categorical)

    -   `citizenship` — grouped nationality categories (categorical)

    -   `region` — Austrian federal region

-   Missing value handling:

    -   Keep only positive values of income (`py010n > 0`)

    -   Convert `hsize` to numeric

    -   Remove observations with missing values

-   Subsetting:

    -   Only individuals living in **Styria** and **Carinthia** (South Austria, NUTS-1 region)

# #Running code

# 3. Load packages

#options(repos = c(CRAN = <https://cloud.r-project.org))>

```{r}
suppressPackageStartupMessages({
  library(tidyverse)
  library(readxl)
  library(simFrame)
  library(dplyr)        # data manipulation
  library(ggplot2)      # visualization
  library(tidyr)        # data tidying
  library(forcats)      # factor management
  library(effects)  # effect plots
  library(gt)
})

```

# 4. Load data and select variables

```{r}

data(eusilcP)

dat = eusilcP

str(eusilcP) 

head(eusilcP)

summary(eusilcP)

```

------------------------------------------------------------------------

\# 5. Data preparation

\- Filter for South Austria regions (Styria and Carinthia)

\- Keep only positive income observations

\- Convert household size to numeric

\- Remove missing values

\- Group citizenship categories if needed

```{r}

dat <- eusilcP %>%

  select(py010n, gender, citizenship, hsize, age, region) %>%

  filter(region %in% c("Carinthia", "Styria")) %>%

  filter(py010n > 0) %>%

  na.omit()

 

dat$gender <- as.factor(dat$gender)

dat$citizenship <- as.factor(dat$citizenship)

dat$hsize <- as.numeric(as.character(dat$hsize))
```

```{r}
 # Initial model with interaction Preview for Regression Stage

model_int <- lm(py010n ~ gender * citizenship + hsize + age, data = dat)

anova(model_int)

summary(model_int)

 

qqnorm(residuals(model_int))

qqline(residuals(model_int))

plot(allEffects(model_int))
```




------------------------------------------------------------------------

# 6. Descriptive statistics

## 6.1 Numeric summaries

```{r}

# Summaries
summ_py010n <- summary(dat$py010n)
summ_age    <- summary(dat$age)
summ_hsize  <- summary(dat$hsize)


summ_py010n
summ_age
summ_hsize

```

## 6.2 Frequency tables

```{r}

table(dat$gender)

table(dat$citizenship)

```

------------------------------------------------------------------------

# 7. Univariate visualizations

## 7.1 Employment income (py010n)

```{r}

ggplot(dat, aes(x = py010n)) +

  geom_histogram(bins = 50) +

  labs(title = "Histogram of employment income (py010n)")
#The histogram of income shows a strong right skew, with a few very high earners
```

```{r}

ggplot(dat, aes(y = py010n)) +

  geom_boxplot() +

  labs(title = "Boxplot of employment income (py010n)")
#
```

## 7.2 Age

```{r}

ggplot(dat, aes(x = age)) + geom_histogram(bins = 30)
#Age distribution is roughly uniform with fewer very old respondents

```

```{r}

ggplot(dat, aes(y = age)) + geom_boxplot()

```

## 7.3 Household size (hsize)

```{r}

ggplot(dat, aes(x = as.numeric(hsize))) +

  geom_histogram(binwidth = 1) +

  labs(title = "Histogram of Household Size")

```

```{r}

ggplot(dat, aes(y = hsize)) + geom_boxplot()

```

## 7.4 Gender

```{r}

ggplot(dat, aes(x = gender)) + geom_bar()

```

## 7.5 Citizenship

```{r}

ggplot(dat, aes(x = citizenship)) +

  geom_bar() +

  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +

  labs(title = "Frequency of citizenship")
#Income differences by gender appear stronger among Austrian citizens than among non‑citizens
```

------------------------------------------------------------------------

# 8. Bivariate plots (predictors vs response)

## 8.1 Gender vs income

```{r}

ggplot(dat, aes(x = gender, y = py010n)) +

  geom_boxplot() +

  labs(title = "Income vs gender")

```

## 8.2 Citizenship vs income

```{r}

ggplot(dat, aes(x = citizenship, y = py010n)) +

  geom_boxplot() +

  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +

  labs(title = "Income vs citizenship")

```

## 8.3 Age vs income

```{r}
ggplot(dat, aes(x = age, y = py010n)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Income vs Age (Linear Fit)",
       x = "Age",
       y = "Net Employment Income")
#The fitted linear regression line shows a positive association between age and income. On average, older individuals earn more, although the scatterplot reveals substantial variation around the line

```

## 8.4 Household size vs income

```{r}
ggplot(dat, aes(x = hsize, y = py010n)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Income vs Household Size",
       x = "Household Size",
       y = "Net Employment Income")


```

------------------------------------------------------------------------

# 9. Interaction plots

## 9.1 Gender × Citizenship

```{r}

ggplot(dat, aes(x = gender, y = py010n, fill = citizenship)) +

  geom_boxplot(position = "dodge") +

  labs(title = "Income interaction: gender × citizenship")

```

## 9.2 Age × Gender

```{r}

ggplot(dat, aes(x = age, y = py010n, color = gender)) +

  geom_point(alpha = 0.3) +

  geom_smooth() +

  labs(title = "Income interaction: age × gender")

```

## 9.3 Age × Citizenship

```{r}

ggplot(dat, aes(x = age, y = py010n, color = citizenship)) +

  geom_point(alpha = 0.3) +

  geom_smooth() +

  labs(title = "Income interaction: age × citizenship")

```

## 9.4 Household Size × Gender

```{r}

ggplot(dat, aes(x = hsize, y = py010n, color = gender)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "loess") +
  labs(title = "Income interaction: Household Size × Gender (Loess)")


```

## 9.5 Household Size × Citizenship

```{r}

ggplot(dat, aes(x = hsize, y = py010n, color = citizenship)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "lm") +
  labs(title = "Income interaction: Household Size × Citizenship",
       x = "Household Size",
       y = "Net Employment Income")


```

# 

# 10. Contingency tables (categorical × categorical)

```{r}

table(dat$gender, dat$citizenship)

```

-   If categories are too detailed, merge small ones:

```{r}

dat$citizenship <- fct_lump(dat$citizenship, n = 3)

table(dat$gender, dat$citizenship)
```

```{r}
# Extra visualization: Age vs Income with 2D density contours
ggplot(dat, aes(x = age, y = py010n)) +
  geom_point(alpha = 0.3) +
  geom_density_2d(color = "blue") +
  labs(title = "Income vs Age with 2D Density Contours",
       x = "Age",
       y = "Net Employment Income (py010n)")
#The contingency table of gender × citizenship shows that most respondents are Austrian citizens, with smaller groups from other EU countries and non‑EU countries. Within each citizenship category, both men and women are represented, though the Austrian group is clearly dominant. This confirms that the sample has enough observations in each cell to allow meaningful comparison, while highlighting that analyses involving non‑EU citizens may be based on fewer cases.
```


Compares income distributions across citizenship groups, separately for men and women.

```{r}
# Boxplot of income by citizenship, split by gender
ggplot(dat, aes(x = citizenship, y = py010n, fill = gender)) +
  geom_boxplot(position = "dodge") +
  labs(title = "Income distributions across citizenship groups by gender",
       x = "Citizenship",
       y = "Net Employment Income (py010n)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

#The comparison of employment income (py010n) across citizenship groups, separately for men and women, shows that Austrian citizens generally report higher median incomes than non‑EU citizens, while EU citizens are closer to the Austrian group. Within each citizenship category, men consistently earn more than women, highlighting both gender and citizenship disparities in income distribution.

```

# 11. Summary

- The income variable is highly right-skewed with outliers.  
- Men typically have higher median employment income than women.  
- Citizenship differences may indicate structural inequality in wages.  
- Age and income show a nonlinear increasing pattern.  
- Larger households do not clearly correlate with higher or lower income.  
- Some interaction effects appear visible (gender × citizenship, etc.), though regression results show no significant interaction.  
- The regression model explains about 17% of income variance, suggesting other unobserved factors are important.

